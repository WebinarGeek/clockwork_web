<!DOCTYPE html>
<html>
  <head>
    <title>Clockwork</title>

    <meta charset="utf-8" />

    <style>
      body {
        font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
        margin: 0;
        padding: 20px;
        font-size: 14px;
        line-height: 1.4;
        color: #333;
      }

      a, a:visited, a:active {
        color: #428bca;
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        border-spacing: 0;
        margin-bottom: 20px;
      }

      th {
        text-align: left;
        border-bottom: solid 2px #ddd;
      }

      table td, table th {
        padding: 8px;
      }

      td {
        border-top: solid 1px #ddd;
      }

      .disabled {
        background-color: pink;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <table>
        <thead>
          <tr>
            <th>Job</th>
            <th style="width: 15%;">Period</th>
            <th style="width: 15%;">Last Run</th>
            <th style="width: 15%;">Action</th>
          </tr>
        </thead>
        <tbody>
          <% @events.each do |event| %>
            <% enabled = ClockworkWeb.enabled?(event.job) %>
            <tr class="<%= enabled ? "" : "disabled" %>">
              <td><%= event.job %></td>
              <td>
                <%= friendly_period(event.instance_variable_get(:@period)) %>
                <% at = event.instance_variable_get(:@at) %>
                <% if at %>
                  at <%= friendly_time_part(at.instance_variable_get(:@hour)) %>:<%= friendly_time_part(at.instance_variable_get(:@min)) %>
                <% end %>
                <% if event.instance_variable_get(:@if) %>
                  if __
                <% end %>
              </td>
              <td><%= last_run(event) %></td>
              <td><%= button_to enabled ? "Disable" : "Enable", home_job_path(job: event.job, enable: !enabled) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </body>
</html>
